<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP å·¥ä½œæµç¨‹å›¾</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .content {
            padding: 40px;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            font-size: 16px;
        }
        
        /* å¢å¤§Mermaidå›¾ä¸­çš„å­—ä½“ */
        .mermaid .actor {
            font-size: 18px !important;
        }
        
        .mermaid .messageText {
            font-size: 16px !important;
        }
        
        .mermaid .noteText {
            font-size: 16px !important;
        }
        
        .mermaid .label {
            font-size: 16px !important;
        }
        .description {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        .description h3 {
            color: #667eea;
            margin-top: 0;
        }
        .stage {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
        .stage h4 {
            margin: 0 0 10px 0;
            color: #28a745;
        }
        .stage ul {
            margin: 0;
            padding-left: 20px;
        }
        .stage li {
            margin: 5px 0;
        }
        .note {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .note h4 {
            color: #1976d2;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– MCP å·¥ä½œæµç¨‹å›¾</h1>
            <p>ä»ç”¨æˆ·æŒ‡ä»¤åˆ°é‚®ä»¶å‘é€çš„å®Œæ•´è‡ªåŠ¨åŒ–æµç¨‹</p>
        </div>
        
        <div class="content">
            <div class="mermaid">
sequenceDiagram
    participant User as ğŸ‘¤ ç”¨æˆ·
    participant Client as ğŸ¤– MCP Client
    participant LLM as ğŸ§  LLM (å¤§æ¨¡å‹)
    participant Server as ğŸ–¥ï¸ MCP Server
    participant Tools as ğŸ”§ å·¥å…·é›†
    participant Files as ğŸ“ æ–‡ä»¶ç³»ç»Ÿ

    Note over User, Files: 1. åˆå§‹åŒ–é˜¶æ®µ
    User->>Client: è¾“å…¥æŸ¥è¯¢æŒ‡ä»¤<br/>"åˆ†æç¾å›½å…³ç¨çƒ­ç‚¹æ–°é—»ï¼Œ<br/>å¹¶å‘é€é‚®ä»¶ç»™xxx@qq.com"
    Client->>Client: ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶å<br/>sentiment_ç¾å›½å…³ç¨_20250730_154329.md
    Client->>LLM: å‘é€å·¥å…·åˆ—è¡¨ + ç”¨æˆ·æŒ‡ä»¤<br/>è¯·æ±‚ç”Ÿæˆå·¥å…·è°ƒç”¨è®¡åˆ’
    LLM->>Client: è¿”å›JSONæ ¼å¼çš„å·¥å…·è°ƒç”¨è®¡åˆ’<br/>[{"name": "search_google_news", "args": {...}},<br/>{"name": "analyze_sentiment", "args": {...}},<br/>{"name": "send_email_with_attachment", "args": {...}}]

    Note over User, Files: 2. æ–°é—»æœç´¢é˜¶æ®µ
    Client->>Server: è°ƒç”¨ search_google_news å·¥å…·<br/>å‚æ•°: {"keyword": "ç¾å›½å…³ç¨"}
    Server->>Tools: è°ƒç”¨ Serper API æœç´¢Googleæ–°é—»
    Tools->>Server: è¿”å›æ–°é—»æ•°æ®
    Server->>Files: ä¿å­˜æ–°é—»æ•°æ®åˆ°JSONæ–‡ä»¶<br/>./google_news/google_news_20250730_154329.json
    Server->>Client: è¿”å›æœç´¢ç»“æœ<br/>"âœ… å·²è·å–ç›¸å…³æ–°é—»...<br/>ğŸ“„ å·²ä¿å­˜åˆ°ï¼š./google_news/..."

    Note over User, Files: 3. æƒ…æ„Ÿåˆ†æé˜¶æ®µ
    Client->>Server: è°ƒç”¨ analyze_sentiment å·¥å…·<br/>å‚æ•°: {"text": "å®é™…æ–°é—»å†…å®¹...", "filename": "sentiment_ç¾å›½å…³ç¨_20250730_154329.md"}
    Server->>LLM: å‘é€æƒ…æ„Ÿåˆ†æè¯·æ±‚<br/>"è¯·å¯¹ä»¥ä¸‹æ–°é—»å†…å®¹è¿›è¡Œæƒ…ç»ªå€¾å‘åˆ†æ..."
    LLM->>Server: è¿”å›æƒ…æ„Ÿåˆ†æç»“æœ
    Server->>Files: ç”ŸæˆMarkdownæŠ¥å‘Š<br/>./sentiment_reports/sentiment_ç¾å›½å…³ç¨_20250730_154329.md
    Server->>Client: è¿”å›æ–‡ä»¶è·¯å¾„

    Note over User, Files: 4. é‚®ä»¶å‘é€é˜¶æ®µ
    Client->>Server: è°ƒç”¨ send_email_with_attachment å·¥å…·<br/>å‚æ•°: {"to": "xxx@qq.com", "subject": "...", "body": "...", "filename": "sentiment_ç¾å›½å…³ç¨_20250730_154329.md"}
    Server->>Files: è¯»å–Markdownæ–‡ä»¶ä½œä¸ºé™„ä»¶
    Server->>Tools: é€šè¿‡SMTPå‘é€é‚®ä»¶
    Tools->>Server: è¿”å›å‘é€ç»“æœ
    Server->>Client: è¿”å›å‘é€çŠ¶æ€<br/>"âœ… é‚®ä»¶å·²æˆåŠŸå‘é€..."

    Note over User, Files: 5. æœ€ç»ˆå“åº”é˜¶æ®µ
    Client->>LLM: å‘é€å®Œæ•´å¯¹è¯å†å²<br/>è¯·æ±‚ç”Ÿæˆæœ€ç»ˆå›å¤
    LLM->>Client: è¿”å›æ€»ç»“æ€§å›å¤
    Client->>Files: ä¿å­˜å¯¹è¯è®°å½•<br/>./llm_outputs/æŸ¥è¯¢_20250730_154329.txt
    Client->>User: æ˜¾ç¤ºæœ€ç»ˆç»“æœ<br/>"åˆ†æå®Œæˆï¼Œé‚®ä»¶å·²å‘é€..."
            </div>

            <div class="description">
                <h3>ğŸ“‹ å·¥ä½œæµç¨‹è¯¦ç»†è¯´æ˜</h3>
                
                <div class="stage">
                    <h4>1ï¸âƒ£ åˆå§‹åŒ–é˜¶æ®µ</h4>
                    <ul>
                        <li><strong>ç”¨æˆ·è¾“å…¥</strong>ï¼šè‡ªç„¶è¯­è¨€æŸ¥è¯¢æŒ‡ä»¤</li>
                        <li><strong>æ–‡ä»¶åç”Ÿæˆ</strong>ï¼šå®¢æˆ·ç«¯é¢„ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„Markdownæ–‡ä»¶å</li>
                        <li><strong>å·¥å…·è§„åˆ’</strong>ï¼šLLMæ ¹æ®ç”¨æˆ·æŒ‡ä»¤å’Œå¯ç”¨å·¥å…·ç”Ÿæˆè°ƒç”¨è®¡åˆ’</li>
                    </ul>
                </div>

                <div class="stage">
                    <h4>2ï¸âƒ£ æ–°é—»æœç´¢é˜¶æ®µ</h4>
                    <ul>
                        <li><strong>å·¥å…·è°ƒç”¨</strong>ï¼šsearch_google_news å·¥å…·</li>
                        <li><strong>APIè°ƒç”¨</strong>ï¼šä½¿ç”¨Serper APIæœç´¢Googleæ–°é—»</li>
                        <li><strong>æ•°æ®ä¿å­˜</strong>ï¼šå°†æœç´¢ç»“æœä¿å­˜ä¸ºJSONæ–‡ä»¶</li>
                        <li><strong>è¿”å›ç»“æœ</strong>ï¼šåŒ…å«æˆåŠŸæ¶ˆæ¯å’Œæ–‡ä»¶è·¯å¾„</li>
                    </ul>
                </div>

                <div class="stage">
                    <h4>3ï¸âƒ£ æƒ…æ„Ÿåˆ†æé˜¶æ®µ</h4>
                    <ul>
                        <li><strong>å·¥å…·è°ƒç”¨</strong>ï¼šanalyze_sentiment å·¥å…·</li>
                        <li><strong>LLMåˆ†æ</strong>ï¼šå°†å®é™…æ–°é—»å†…å®¹å‘é€ç»™LLMè¿›è¡Œæƒ…æ„Ÿåˆ†æ</li>
                        <li><strong>æŠ¥å‘Šç”Ÿæˆ</strong>ï¼šç”ŸæˆåŒ…å«åŸå§‹æ–‡æœ¬å’Œåˆ†æç»“æœçš„MarkdownæŠ¥å‘Š</li>
                        <li><strong>æ–‡ä»¶ä¿å­˜</strong>ï¼šä¿å­˜åˆ°sentiment_reportsç›®å½•</li>
                    </ul>
                </div>

                <div class="stage">
                    <h4>4ï¸âƒ£ é‚®ä»¶å‘é€é˜¶æ®µ</h4>
                    <ul>
                        <li><strong>å·¥å…·è°ƒç”¨</strong>ï¼šsend_email_with_attachment å·¥å…·</li>
                        <li><strong>é™„ä»¶è¯»å–</strong>ï¼šè¯»å–ç”Ÿæˆçš„Markdownæ–‡ä»¶</li>
                        <li><strong>SMTPå‘é€</strong>ï¼šé€šè¿‡SMTPæœåŠ¡å™¨å‘é€é‚®ä»¶</li>
                        <li><strong>çŠ¶æ€è¿”å›</strong>ï¼šè¿”å›å‘é€æˆåŠŸæˆ–å¤±è´¥çŠ¶æ€</li>
                    </ul>
                </div>

                <div class="stage">
                    <h4>5ï¸âƒ£ æœ€ç»ˆå“åº”é˜¶æ®µ</h4>
                    <ul>
                        <li><strong>å¯¹è¯æ€»ç»“</strong>ï¼šLLMç”Ÿæˆæ€»ç»“æ€§å›å¤</li>
                        <li><strong>è®°å½•ä¿å­˜</strong>ï¼šä¿å­˜å®Œæ•´å¯¹è¯å†å²</li>
                        <li><strong>ç”¨æˆ·åé¦ˆ</strong>ï¼šå‘ç”¨æˆ·æ˜¾ç¤ºæœ€ç»ˆç»“æœ</li>
                    </ul>
                </div>

                <div class="note">
                    <h4>ğŸ’¡ è¯´æ˜</h4>
                    <p>æ­¤ç®€åŒ–ç‰ˆæµç¨‹å›¾ç•¥å»äº†å ä½ç¬¦è§£æé˜¶æ®µï¼Œç›´æ¥å±•ç¤ºä»æ–°é—»æœç´¢åˆ°æƒ…æ„Ÿåˆ†æçš„æ•°æ®ä¼ é€’è¿‡ç¨‹ã€‚åœ¨å®é™…å®ç°ä¸­ï¼ŒMCP Clientä¼šè‡ªåŠ¨å¤„ç†å ä½ç¬¦è§£æï¼Œå°†æ–°é—»æ•°æ®æ­£ç¡®ä¼ é€’ç»™æƒ…æ„Ÿåˆ†æå·¥å…·ã€‚</p>
                </div>
            </div>

            <div class="description">
                <h3>ğŸ”§ æŠ€æœ¯è¦ç‚¹</h3>
                
                <div class="stage">
                    <h4>æ–‡ä»¶å‘½åè§„åˆ™</h4>
                    <ul>
                        <li><strong>æ–°é—»æ•°æ®</strong>ï¼šgoogle_news_YYYYMMDD_HHMMSS.json</li>
                        <li><strong>åˆ†ææŠ¥å‘Š</strong>ï¼šsentiment_å…³é”®è¯_YYYYMMDD_HHMMSS.md</li>
                        <li><strong>å¯¹è¯è®°å½•</strong>ï¼šæŸ¥è¯¢_YYYYMMDD_HHMMSS.txt</li>
                    </ul>
                </div>

                <div class="stage">
                    <h4>æ•°æ®æµå‘</h4>
                    <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto;">
ç”¨æˆ·æŒ‡ä»¤ â†’ å·¥å…·è§„åˆ’ â†’ æ–°é—»æœç´¢ â†’ æƒ…æ„Ÿåˆ†æ â†’ æŠ¥å‘Šç”Ÿæˆ â†’ é‚®ä»¶å‘é€ â†’ ç»“æœåé¦ˆ
    â†“         â†“         â†“         â†“         â†“         â†“         â†“
  è‡ªç„¶è¯­è¨€   JSONè®¡åˆ’   JSONæ•°æ®   LLMåˆ†æ   Markdown   SMTPå‘é€   ç”¨æˆ·ç•Œé¢</pre>
                </div>

                <div class="stage">
                    <h4>æ ¸å¿ƒç»„ä»¶</h4>
                    <ul>
                        <li><strong>MCP Client</strong>ï¼šåè°ƒæ•´ä¸ªå·¥ä½œæµç¨‹ï¼Œç®¡ç†å·¥å…·è°ƒç”¨</li>
                        <li><strong>MCP Server</strong>ï¼šæä¾›å·¥å…·æœåŠ¡ï¼Œæ‰§è¡Œå…·ä½“æ“ä½œ</li>
                        <li><strong>LLM</strong>ï¼šè¿›è¡Œå·¥å…·è§„åˆ’å’Œæƒ…æ„Ÿåˆ†æ</li>
                        <li><strong>å¤–éƒ¨API</strong>ï¼šæ–°é—»æœç´¢å’Œé‚®ä»¶å‘é€æœåŠ¡</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            },
            sequence: {
                useMaxWidth: true,
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 60,
                width: 180,
                height: 80,
                boxMargin: 15,
                boxTextMargin: 8,
                noteMargin: 15,
                messageMargin: 40,
                mirrorActors: true,
                bottomMarginAdj: 1,
                useMaxWidth: true,
                rightAngles: false,
                showSequenceNumbers: false,
                fontSize: 16
            }
        });
    </script>
</body>
</html> 